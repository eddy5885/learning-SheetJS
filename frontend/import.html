<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡¨æ ¼å¯¼å‡ºä¸ºJSON</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>

</head>

<body>
    <button id="loadBtn">åŠ è½½ Excel å¹¶è§£æä¸º JSON</button>
    <button id="loadHtmlBtn">åŠ è½½ Excel å¹¶è½¬æ¢ä¸º HTML</button>
    <pre id="output"
        style="margin-top:16px; background:#f6f8fa; padding:16px; border-radius:8px; max-width:100vw; overflow:auto;"></pre>
    <div id="htmlOutput" style="margin-top:16px;"></div>
    <script>
        const url = "https://file.sixue.work/2.xlsx";

        // åŠ è½½å¹¶è§£æä¸º JSON
        document.getElementById('loadBtn').onclick = async function () {
            const output = document.getElementById('output');
            const htmlOutput = document.getElementById('htmlOutput');
            output.textContent = 'æ­£åœ¨åŠ è½½...';
            htmlOutput.innerHTML = '';
            try {
                const res = await fetch(url);
                const arrayBuffer = await res.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer);
                const sheets = workbook.SheetNames.map(sheetName => {
                    const worksheet = workbook.Sheets[sheetName];
                    const data = XLSX.utils.sheet_to_json(worksheet, {
                        header: 1,
                        defval: null
                    });
                    return { sheetName, data };
                });
                const json = {
                    sheetCount: workbook.SheetNames.length,
                    sheets
                };
                output.textContent = JSON.stringify(json, null, 2);
            } catch (e) {
                output.textContent = 'åŠ è½½æˆ–è§£æå‡ºé”™ï¼š' + e;
            }
        };

        // åŠ è½½å¹¶è½¬æ¢ä¸º HTML
        document.getElementById('loadHtmlBtn').onclick = async function () {
            const output = document.getElementById('output');
            const htmlOutput = document.getElementById('htmlOutput');
            output.textContent = '';
            htmlOutput.innerHTML = 'æ­£åœ¨åŠ è½½...';
            try {
                const res = await fetch(url);
                const arrayBuffer = await res.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer);
                
                // å°†æ‰€æœ‰sheetè½¬æ¢ä¸ºHTML
                let allHtml = '';
                workbook.SheetNames.forEach(sheetName => {
                    const worksheet = workbook.Sheets[sheetName];
                    const html = XLSX.utils.sheet_to_html(worksheet);
                    allHtml += `<h3 style="margin:16px 0 8px;">ğŸ“„ ${sheetName}</h3>${html}`;
                });
                htmlOutput.innerHTML = allHtml;
                
                // æ·»åŠ è¡¨æ ¼æ ·å¼
                htmlOutput.querySelectorAll('table').forEach(table => {
                    table.style.borderCollapse = 'collapse';
                    table.style.width = '100%';
                    table.style.marginBottom = '16px';
                });
                htmlOutput.querySelectorAll('td, th').forEach(cell => {
                    cell.style.border = '1px solid #ddd';
                    cell.style.padding = '8px';
                });
            } catch (e) {
                htmlOutput.innerHTML = 'åŠ è½½æˆ–è§£æå‡ºé”™ï¼š' + e;
            }
        };
    </script>

</body>

</html>